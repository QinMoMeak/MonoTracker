import{r as h,j as e}from"./index-B26G8B5L.js";import{i as M,u as V,a as B,b as L,c as D}from"./echarts-DM9oL0h8.js";import"./react--Eh9ivFN.js";import"./capacitor-CFuNkP-E.js";V([B,L,D]);const N=128,f=["<1M","1-6M","6-12M","1-3Y",">3Y"],R=t=>{const n=Number.isFinite(t)?t:0,a=Math.max(0,n);return Math.log10(a+1)},F=(t,n=.22)=>{if(t.length<=2)return t.slice();const a=t.slice();for(let r=1;r<t.length-1;r++){const d=t[r-1],l=t[r],m=t[r+1];if(!((l-d)*(l-m)<=0)){a[r]=l;continue}const x=(d+m)/2,o=l*(1-n)+x*n,p=Math.min(d,m),c=Math.max(d,m);a[r]=Math.min(c,Math.max(p,o))}return a},w=({labels:t,values:n,height:a,themeColorClass:r})=>{const d=h.useRef(null),l=h.useRef(null),m=h.useRef(null),u=h.useMemo(()=>{const p=n.map(c=>Number.isFinite(c)?c:0).map(R);return F(p,.22)},[n]),x=h.useCallback(()=>{var o;(o=l.current)==null||o.resize()},[]);return h.useEffect(()=>{if(!d.current||l.current)return;const o=M(d.current,void 0,{renderer:"canvas"});l.current=o;const p=new ResizeObserver(()=>{var c;return(c=l.current)==null?void 0:c.resize()});return p.observe(d.current),m.current=p,window.addEventListener("resize",x),()=>{var c,j;window.removeEventListener("resize",x),(c=m.current)==null||c.disconnect(),m.current=null,(j=l.current)==null||j.dispose(),l.current=null}},[x]),h.useEffect(()=>{if(!d.current||!l.current)return;const o=window.getComputedStyle(d.current).color,p={animation:!0,grid:{left:6,right:6,top:6,bottom:0,containLabel:!1},xAxis:{type:"category",boundaryGap:!1,data:t,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},yAxis:{type:"value",min:c=>{const j=c.max-c.min;return Math.max(0,c.min-j*.25)},max:c=>c.max*1.05,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},series:[{type:"line",data:u,smooth:.6,smoothMonotone:"x",cubicInterpolationMode:"monotone",symbol:"none",showSymbol:!1,lineStyle:{width:3,color:o,cap:"round",join:"round"},itemStyle:{color:o},areaStyle:{color:o,opacity:.12}}]};l.current.setOption(p,{notMerge:!0,lazyUpdate:!0}),l.current.resize()},[t,u,r,a]),e.jsx("div",{ref:d,className:`w-full ${r}`,style:{height:`${a}px`}})},q=({stats:t,language:n,TEXTS:a,ICONS:r,CATEGORY_CONFIG:d,themeColors:l,currencySymbol:m,formatNumber:u,toNumber:x,getStatusLabel:o,getCategoryLabel:p,getChannelLabel:c,topN:j,onTopNChange:k})=>{const y=h.useMemo(()=>t.monthlySpend.reduce((s,i)=>s+(Number.isFinite(i.value)?i.value:0),0),[t.monthlySpend]),$=h.useMemo(()=>t.monthlySpend.map(s=>s.month),[t.monthlySpend]),z=h.useMemo(()=>t.monthlySpend.map(s=>x(s.value)),[t.monthlySpend,x]),b=h.useMemo(()=>f.map(s=>x(t.durationBuckets[s]??0)),[t.durationBuckets,x]),g=h.useMemo(()=>b.reduce((s,i)=>s+(Number.isFinite(i)?i:0),0),[b]);return e.jsxs("div",{className:"p-6 space-y-6 pb-32",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-bold opacity-80 flex items-center gap-2",children:[e.jsx(r.PieChart,{size:20})," ",a.statsOverview[n]]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-5 rounded-[2rem] shadow-sm transition-colors",children:[e.jsx("p",{className:"text-xs opacity-50 uppercase font-bold mb-1",children:a.totalValue[n]}),e.jsxs("p",{className:`text-2xl font-light ${l.secondary}`,children:[m,u(t.totalVal)]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-5 rounded-[2rem] shadow-sm transition-colors",children:[e.jsx("p",{className:"text-xs opacity-50 uppercase font-bold mb-1",children:a.itemCount[n]}),e.jsx("p",{className:"text-2xl font-light text-gray-800 dark:text-gray-100",children:t.totalCount})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 mb-4 flex items-center gap-2",children:[e.jsx(r.BarChart2,{size:16})," ",a.statsMonthlyTrend[n]]}),e.jsxs("div",{className:"space-y-3",children:[y<=0&&e.jsx("p",{className:"text-xs opacity-40",children:a.noData[n]}),y>0&&t.monthlySpend.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(w,{labels:$,values:z,height:N,themeColorClass:l.secondary}),e.jsx("div",{className:"grid gap-1 text-center",style:{gridTemplateColumns:`repeat(${t.monthlySpend.length}, minmax(0, 1fr))`},children:t.monthlySpend.map(({month:s,value:i})=>e.jsxs("div",{className:"text-[10px] text-gray-400 font-medium",children:[e.jsxs("div",{className:"text-[10px] text-gray-500 dark:text-gray-300",children:[m,u(x(i),0)]}),e.jsx("div",{className:"mt-1",children:s})]},s))})]}),y>0&&t.monthlySpend.length===0&&e.jsx("p",{className:"text-xs opacity-40",children:a.none[n]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 mb-4 flex items-center gap-2",children:[e.jsx(r.Layers,{size:16})," ",a.statsStatusDist[n]]}),e.jsxs("div",{className:"space-y-3",children:[t.statusStats.map(s=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"capitalize font-medium",children:o(s.status)}),e.jsxs("span",{className:"opacity-60",children:[s.count," (",s.percent.toFixed(1),"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${l.primary}`,style:{width:`${s.percent}%`,opacity:.7}})})]},s.status)),t.statusStats.length===0&&e.jsx("p",{className:"text-center text-xs opacity-40",children:a.noData[n]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 mb-4 flex items-center gap-2",children:[e.jsx(r.Clock,{size:16})," ",a.statsDuration[n]]}),e.jsxs("div",{className:"space-y-3",children:[g<=0&&e.jsx("p",{className:"text-xs opacity-40",children:a.noData[n]}),g>0&&e.jsxs(e.Fragment,{children:[e.jsx(w,{labels:f,values:b,height:N,themeColorClass:l.secondary}),e.jsx("div",{className:"grid gap-1 text-center",style:{gridTemplateColumns:`repeat(${f.length}, minmax(0, 1fr))`},children:f.map(s=>{const i=x(t.durationBuckets[s]??0);return e.jsxs("div",{className:"text-[10px] text-gray-400 font-medium",children:[e.jsx("div",{className:"text-[10px] text-gray-500 dark:text-gray-300",children:u(i,0)}),e.jsx("div",{className:"mt-1",children:s})]},s)})})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 flex items-center gap-2",children:[e.jsx(r.BarChart2,{size:16})," ",a.statsCategoryTrend[n]]}),e.jsx("div",{className:"flex gap-2",children:[3,5,10].map(s=>e.jsxs("button",{onClick:()=>k(s),className:`px-2 py-1 text-[10px] font-bold rounded-full transition-all ${j===s?`${l.primary} text-white`:"bg-gray-100 dark:bg-slate-800 text-gray-500 dark:text-gray-400"}`,children:["TOP ",s]},s))})]}),e.jsxs("div",{className:"space-y-4",children:[t.catStatsByValue.slice(0,j).map(s=>{const i=d[s.cat]||d.other,v=i.icon;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded-md ${i.bg}`,children:e.jsx(v,{size:12,className:i.color})}),e.jsx("span",{className:"text-sm font-medium",children:p(s.cat)})]}),e.jsxs("span",{className:"text-sm font-bold",children:[m,u(s.value)]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${i.color.replace(/text-(\w+)-(\d+)/,"bg-$1-$2")}`,style:{width:`${s.percentVal}%`}})})]},s.cat)}),t.catStatsByValue.length===0&&e.jsx("p",{className:"text-center text-xs opacity-40",children:a.none[n]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 mb-4 flex items-center gap-2",children:[e.jsx(r.BarChart2,{size:16})," ",a.statsChannelTrend[n]]}),e.jsxs("div",{className:"space-y-4",children:[t.channelStats.map(s=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:c(s.channel)}),e.jsxs("span",{className:"text-sm font-bold",children:[m,u(s.value)]})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${l.primary}`,style:{width:`${s.percentVal}%`,opacity:.7}})})]},s.channel)),t.channelStats.length===0&&e.jsx("p",{className:"text-center text-xs opacity-40",children:a.none[n]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 mb-4 flex items-center gap-2",children:[e.jsx(r.BarChart2,{size:16})," ",a.statsCountDist[n]]}),e.jsx("div",{className:"space-y-4",children:t.catStatsByCount.slice(0,6).map(s=>{const i=d[s.cat]||d.other,v=i.icon;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1 rounded-md ${i.bg}`,children:e.jsx(v,{size:12,className:i.color})}),e.jsx("span",{className:"text-sm font-medium",children:p(s.cat)})]}),e.jsx("span",{className:"text-sm font-bold",children:s.count})]}),e.jsx("div",{className:"h-1.5 w-full bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${i.color.replace(/text-(\w+)-(\d+)/,"bg-$1-$2")}`,style:{width:`${s.percentCount}%`}})})]},s.cat)})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-sm transition-colors",children:[e.jsxs("h3",{className:"text-sm font-bold opacity-70 mb-4 flex items-center gap-2",children:[e.jsx(r.TrendingUp,{size:16})," ",a.statsTimeline[n]]}),e.jsxs("div",{className:"space-y-0 relative border-l-2 border-gray-100 dark:border-slate-800 ml-2",children:[t.timelineData.slice(0,10).map(s=>e.jsxs("div",{className:"mb-6 ml-4 relative",children:[e.jsx("div",{className:`absolute -left-[21px] top-1 w-3 h-3 rounded-full border-2 border-white dark:border-slate-900 ${l.primary}`}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 font-mono mb-0.5",children:s.purchaseDate}),e.jsx("p",{className:"text-sm font-bold",children:s.name})]}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 dark:bg-slate-800 font-medium capitalize",children:o(s.status)})]})]},s.id)),t.timelineData.length===0&&e.jsx("p",{className:"ml-4 text-xs opacity-40",children:a.noActivity[n]})]})]})]})};export{q as default};
